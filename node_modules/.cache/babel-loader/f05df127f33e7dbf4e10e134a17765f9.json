{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\src\\\\components\\\\AutotestTable.js\";\nimport React from 'react';\nimport XLSX from 'xlsx';\n\nclass AutotestTable extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tableData: [{\n        \"qrcode\": \"a\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:29\"\n      }, {\n        \"qrcode\": \"b\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:31\"\n      }, {\n        \"qrcode\": \"c\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:33\"\n      }, {\n        \"qrcode\": \"d\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:34\"\n      }, {\n        \"qrcode\": \"e\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:36\"\n      }, {\n        \"qrcode\": \"f\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:37\"\n      }, {\n        \"qrcode\": \"g\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:39\"\n      }, {\n        \"qrcode\": \"h\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:44\"\n      }, {\n        \"qrcode\": \"i\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:46\"\n      }, {\n        \"qrcode\": \"j\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:48\"\n      }, {\n        \"qrcode\": \"k\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:51\"\n      }, {\n        \"qrcode\": \"l\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:52\"\n      }, {\n        \"qrcode\": \"m\",\n        \"power\": \"41\",\n        \"duration\": \"33\",\n        \"dBm\": \"u\",\n        \"dBc\": \"n\",\n        \"timestamp\": \"13:02:54\"\n      }]\n    };\n  }\n\n  componentWillReceiveProps(props) {\n    var finalData = this.checkDuplicate(this.state.tableData, props.addon);\n    this.setState({\n      tableData: finalData\n    });\n  }\n\n  componentDidUpdate() {\n    var scrollDiv = document.querySelector('#autotesttable > div');\n    scrollDiv.scrollTop = scrollDiv.scrollHeight;\n  }\n\n  render() {\n    return React.createElement(\"main\", {\n      id: \"autotesttable\",\n      align: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 24\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 25\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      id: \"data-table\",\n      border: \"1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 26\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 27\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 29\n      },\n      __self: this\n    }, \"#\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 30\n      },\n      __self: this\n    }, \"Serial No.\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 31\n      },\n      __self: this\n    }, \"Power\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32\n      },\n      __self: this\n    }, \"Duration\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 33\n      },\n      __self: this\n    }, \"dBm\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 34\n      },\n      __self: this\n    }, \"dBc\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 35\n      },\n      __self: this\n    }, \"Timestamp\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36\n      },\n      __self: this\n    }, \"Delete\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39\n      },\n      __self: this\n    }, this.state.tableData.map((row, index) => React.createElement(\"tr\", {\n      key: row.qrcode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, index + 1), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, row.qrcode), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, row.power), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, row.duration), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, row.dBm), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, row.dBc), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, row.timestamp), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: _ => this.deleteRow(index),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, \"\\u2715\"))))))), React.createElement(\"button\", {\n      onClick: _ => this.exportData(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, \"Save Excel\"));\n  }\n\n  deleteRow(index) {\n    console.log(index);\n    var duplicateState = [...this.state.tableData];\n    duplicateState.splice(index, 1);\n    this.setState({\n      tableData: duplicateState\n    });\n  }\n\n  checkDuplicate(oldData, newData) {\n    var unique = oldData.filter((val, index) => {\n      return val.qrcode !== newData.qrcode;\n    });\n    unique.push(newData);\n    return unique;\n  }\n\n  formatDate(type) {\n    var dt = new Date();\n    if (type === 'print') return `${dt.getFullYear().toString().padStart(4, '0')}-${(dt.getMonth() + 1).toString().padStart(2, '0')}-${dt.getDate().toString().padStart(2, '0')} ${dt.getHours().toString().padStart(2, '0')}:${dt.getMinutes().toString().padStart(2, '0')}:${dt.getSeconds().toString().padStart(2, '0')}`;\n    if (type === 'save') return `${dt.getFullYear().toString().padStart(4, '0')}-${(dt.getMonth() + 1).toString().padStart(2, '0')}-${dt.getDate().toString().padStart(2, '0')}  (${dt.getHours().toString().padStart(2, '0')}${dt.getMinutes().toString().padStart(2, '0')})`;\n  }\n\n  exportData() {\n    var person = prompt('Please enter OPERATOR NAME');\n\n    if (!person) {\n      alert('OPERATOR NAME is required!');\n      return false;\n    }\n\n    console.table(this.state.tableData);\n    var data = [...this.state.tableData];\n    var newData = data.map((obj, index) => {\n      return Object.assign({\n        index: String(index + 1)\n      }, obj);\n    }); // console.table(newData);\n\n    this.xlsxModule(person, newData);\n  }\n\n  xlsxModule(person, data) {\n    var ws = XLSX.utils.json_to_sheet([{\n      A: 'Operator Name',\n      B: person\n    }, {\n      A: 'Date',\n      B: this.formatDate('print')\n    }], {\n      header: ['A', 'B'],\n      skipHeader: true\n    });\n    XLSX.utils.sheet_add_json(ws, data, {\n      skipHeader: false,\n      origin: 'A4'\n    });\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws);\n    XLSX.writeFile(wb, `Anritsu Test -- ${this.formatDate('save')}.xlsx`);\n  }\n\n}\n\nexport default AutotestTable;","map":{"version":3,"sources":["C:/Users/amnaonoip/Desktop/anritsu-cable-scanner/src/components/AutotestTable.js"],"names":["React","XLSX","AutotestTable","Component","constructor","props","state","tableData","componentWillReceiveProps","finalData","checkDuplicate","addon","setState","componentDidUpdate","scrollDiv","document","querySelector","scrollTop","scrollHeight","render","map","row","index","qrcode","power","duration","dBm","dBc","timestamp","_","deleteRow","exportData","console","log","duplicateState","splice","oldData","newData","unique","filter","val","push","formatDate","type","dt","Date","getFullYear","toString","padStart","getMonth","getDate","getHours","getMinutes","getSeconds","person","prompt","alert","table","data","obj","Object","assign","String","xlsxModule","ws","utils","json_to_sheet","A","B","header","skipHeader","sheet_add_json","origin","wb","book_new","book_append_sheet","writeFile"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport XLSX from 'xlsx';\r\n\r\nclass AutotestTable extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            tableData: [{ \"qrcode\": \"a\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:29\" }, { \"qrcode\": \"b\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:31\" }, { \"qrcode\": \"c\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:33\" }, { \"qrcode\": \"d\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:34\" }, { \"qrcode\": \"e\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:36\" }, { \"qrcode\": \"f\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:37\" }, { \"qrcode\": \"g\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:39\" }, { \"qrcode\": \"h\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:44\" }, { \"qrcode\": \"i\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:46\" }, { \"qrcode\": \"j\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:48\" }, { \"qrcode\": \"k\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:51\" }, { \"qrcode\": \"l\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:52\" }, { \"qrcode\": \"m\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:54\" }]\r\n        };\r\n    }\r\n\r\n    componentWillReceiveProps(props) {\r\n        var finalData = this.checkDuplicate(this.state.tableData, props.addon);\r\n        this.setState({ tableData: finalData });\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        var scrollDiv = document.querySelector('#autotesttable > div');\r\n        scrollDiv.scrollTop = scrollDiv.scrollHeight;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <main id=\"autotesttable\" align=\"center\">\r\n                <div>\r\n                    <table id=\"data-table\" border=\"1\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>#</th>\r\n                                <th>Serial No.</th>\r\n                                <th>Power</th>\r\n                                <th>Duration</th>\r\n                                <th>dBm</th>\r\n                                <th>dBc</th>\r\n                                <th>Timestamp</th>\r\n                                <th>Delete</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {this.state.tableData.map((row, index) => <tr key={row.qrcode}><td>{index + 1}</td><td>{row.qrcode}</td><td>{row.power}</td><td>{row.duration}</td><td>{row.dBm}</td><td>{row.dBc}</td><td>{row.timestamp}</td><td><button onClick={_ => this.deleteRow(index)}>&#10005;</button></td></tr>)}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n                <button onClick={_ => this.exportData()}>Save Excel</button>\r\n            </main>);\r\n    }\r\n\r\n    deleteRow(index) {\r\n        console.log(index);\r\n        var duplicateState = [...this.state.tableData];\r\n        duplicateState.splice(index, 1);\r\n        this.setState({\r\n            tableData: duplicateState\r\n        })\r\n    }\r\n\r\n    checkDuplicate(oldData, newData) {\r\n        var unique = oldData.filter((val, index) => {\r\n            return (val.qrcode !== newData.qrcode);\r\n        });\r\n        unique.push(newData)\r\n        return unique;\r\n    }\r\n\r\n    formatDate(type) {\r\n        var dt = new Date();\r\n        if(type === 'print') return (`${dt.getFullYear().toString().padStart(4, '0')}-${(dt.getMonth() + 1).toString().padStart(2, '0')}-${dt.getDate().toString().padStart(2, '0')} ${dt.getHours().toString().padStart(2, '0')}:${dt.getMinutes().toString().padStart(2, '0')}:${dt.getSeconds().toString().padStart(2, '0')}`);\r\n        if(type === 'save') return (`${dt.getFullYear().toString().padStart(4, '0')}-${(dt.getMonth() + 1).toString().padStart(2, '0')}-${dt.getDate().toString().padStart(2, '0')}  (${dt.getHours().toString().padStart(2, '0')}${dt.getMinutes().toString().padStart(2, '0')})`);\r\n    }\r\n\r\n    exportData() {\r\n        var person = prompt('Please enter OPERATOR NAME');\r\n        if (!person) {\r\n            alert('OPERATOR NAME is required!');\r\n            return false;\r\n        }\r\n        console.table(this.state.tableData)\r\n        var data = [...this.state.tableData];\r\n        var newData = data.map((obj, index) => {\r\n            return Object.assign({ index: String(index + 1) }, obj)\r\n        })\r\n        // console.table(newData);\r\n        this.xlsxModule(person, newData);\r\n    }\r\n\r\n    xlsxModule(person, data) {\r\n        var ws = XLSX.utils.json_to_sheet([{ A: 'Operator Name', B: person }, { A: 'Date', B: this.formatDate('print') }], { header: ['A', 'B'], skipHeader: true });\r\n        XLSX.utils.sheet_add_json(ws, data, { skipHeader: false, origin: 'A4' });\r\n        const wb = XLSX.utils.book_new();\r\n        XLSX.utils.book_append_sheet(wb, ws);\r\n        XLSX.writeFile(wb, `Anritsu Test -- ${this.formatDate('save')}.xlsx`);\r\n    }\r\n}\r\n\r\nexport default AutotestTable;\r\n"]},"metadata":{},"sourceType":"module"}