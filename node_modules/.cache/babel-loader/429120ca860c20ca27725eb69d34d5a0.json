{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import AutotestTable from'./AutotestTable';import connectMachine from'../service';var Autotest=/*#__PURE__*/function(_React$Component){_inherits(Autotest,_React$Component);function Autotest(props){var _this;_classCallCheck(this,Autotest);_this=_possibleConstructorReturn(this,_getPrototypeOf(Autotest).call(this,props));_this.state={newData:{}};return _this;}_createClass(Autotest,[{key:\"render\",value:function render(){return React.createElement(\"main\",{id:\"autotest\"},React.createElement(\"label\",null,\"Output Power Level (dBm): \",React.createElement(\"input\",{type:\"number\",id:\"outputPowerLevel\",onInput:this.savePower,disabled:true})),React.createElement(\"label\",null,\"Test Duration (sec): \",React.createElement(\"input\",{type:\"number\",id:\"testDuration\",onInput:this.saveDuration,disabled:true})),React.createElement(\"br\",null),React.createElement(\"input\",{type:\"text\",id:\"scanner\",placeholder:\"Place scanner here\",onInput:this.waitForQRCode.bind(this),className:\"backgroundAnimated\",autoComplete:\"off\"}),React.createElement(AutotestTable,{addon:this.state.newData}),React.createElement(\"br\",null));}},{key:\"waitForQRCode\",value:function waitForQRCode(){var _this2=this;clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout(function(_){_this2.sendCommandToDevice();},50);}},{key:\"sendCommandToDevice\",value:function sendCommandToDevice(){var _this3=this;var elem=document.getElementById('scanner');var qrcode=elem.value;if(!qrcode)return;var power=document.getElementById('outputPowerLevel').value;var duration=document.getElementById('testDuration').value;connectMachine('INITiate:PIManalyzer:MEASure ON').then(function(data){return connectMachine(':PIManalyzer:MEASure:VALue?');}).then(function(data){_this3.formatFinalData(qrcode,data,power,duration);elem.value='';elem.focus();});}},{key:\"formatFinalData\",value:function formatFinalData(qrcode,peakData,power,duration){// TODO: check this String method requirement.\nvar _this$formatPeakData=this.formatPeakData(String(peakData)),_this$formatPeakData2=_slicedToArray(_this$formatPeakData,2),dBm=_this$formatPeakData2[0],dBc=_this$formatPeakData2[1];var timestamp=this.formatDate();var currentData={qrcode:qrcode,power:power,duration:duration,dBm:dBm,dBc:dBc,timestamp:timestamp};this.setState(function(prevState){return{newData:currentData};});}},{key:\"formatPeakData\",value:function formatPeakData(data){var arr=data.split(',');arr[0]=' '+arr[0]+' dBc';arr[1]=arr[1]+' dBm';arr.reverse();var final=arr.join();return final;}},{key:\"formatDate\",value:function formatDate(){var dt=new Date();return\"\".concat(dt.getHours().toString().padStart(2,'0'),\":\").concat(dt.getMinutes().toString().padStart(2,'0'),\":\").concat(dt.getSeconds().toString().padStart(2,'0'));}},{key:\"savePower\",value:function savePower(evt){if(evt){if(evt.target.value<20)evt.target.value=20;if(evt.target.value>46)evt.target.value=46;localStorage.setItem('power',evt.target.value);}else{var power=43;try{var local=JSON.parse(localStorage.getItem('power'));if(local)power=local;}catch(e){console.log(e);}finally{document.getElementById('outputPowerLevel').value=power;localStorage.setItem('power',power);}}}},{key:\"saveDuration\",value:function saveDuration(evt){if(evt){if(evt.target.value<1)evt.target.value=1;if(evt.target.value>600)evt.target.value=600;localStorage.setItem('duration',evt.target.value);}else{var duration=30;try{var local=JSON.parse(localStorage.getItem('duration'));if(local)duration=local;}catch(e){console.log(e);}finally{document.getElementById('testDuration').value=duration;localStorage.setItem('duration',duration);}}}},{key:\"componentDidMount\",value:function componentDidMount(){// TODO: try to use these methods from PIM class file\nthis.savePower();this.saveDuration();}}]);return Autotest;}(React.Component);export default Autotest;","map":{"version":3,"sources":["C:/Users/amnaonoip/Desktop/anritsu-cable-scanner/src/components/Autotest.js"],"names":["React","AutotestTable","connectMachine","Autotest","props","state","newData","savePower","saveDuration","waitForQRCode","bind","clearTimeout","debounceTimer","setTimeout","_","sendCommandToDevice","elem","document","getElementById","qrcode","value","power","duration","then","data","formatFinalData","focus","peakData","formatPeakData","String","dBm","dBc","timestamp","formatDate","currentData","setState","prevState","arr","split","reverse","final","join","dt","Date","getHours","toString","padStart","getMinutes","getSeconds","evt","target","localStorage","setItem","local","JSON","parse","getItem","e","console","log","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport AutotestTable from './AutotestTable';\r\nimport connectMachine from '../service';\r\n\r\nclass Autotest extends React.Component {\r\n    debounceTimer;\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            newData: {}\r\n        };\r\n    }\r\n\r\n    render() {\r\n        return (<main id=\"autotest\">\r\n            <label>Output Power Level (dBm): <input type=\"number\" id=\"outputPowerLevel\" onInput={this.savePower} disabled={true}/></label>\r\n            <label>Test Duration (sec): <input type=\"number\" id=\"testDuration\" onInput={this.saveDuration}  disabled={true}/></label>\r\n            <br />\r\n            <input type=\"text\" id=\"scanner\" placeholder=\"Place scanner here\" onInput={this.waitForQRCode.bind(this)} className=\"backgroundAnimated\" autoComplete=\"off\" />\r\n            <AutotestTable addon={this.state.newData} />\r\n            <br />\r\n        </main>);\r\n    }\r\n\r\n    waitForQRCode() {\r\n        clearTimeout(this.debounceTimer);\r\n        this.debounceTimer = setTimeout( _ => {\r\n            this.sendCommandToDevice();\r\n        }, 50);\r\n    }\r\n\r\n    sendCommandToDevice() {\r\n        var elem = document.getElementById('scanner');\r\n        var qrcode = elem.value;\r\n        if(!qrcode) return;\r\n\r\n        var power = document.getElementById('outputPowerLevel').value;\r\n        var duration = document.getElementById('testDuration').value;\r\n\r\n        connectMachine('INITiate:PIManalyzer:MEASure ON')\r\n        .then( data => {\r\n            return connectMachine(':PIManalyzer:MEASure:VALue?');\r\n        })\r\n        .then( data => {\r\n            this.formatFinalData(qrcode, data, power, duration);\r\n            elem.value = '';\r\n            elem.focus();\r\n        });\r\n    }\r\n\r\n    formatFinalData(qrcode, peakData, power, duration) {\r\n        // TODO: check this String method requirement.\r\n        var [dBm, dBc] = this.formatPeakData(String(peakData));\r\n        var timestamp = this.formatDate();\r\n\r\n        var currentData = { qrcode, power, duration, dBm, dBc, timestamp };\r\n\r\n        this.setState(prevState => ({\r\n            newData: currentData\r\n        }));\r\n    }\r\n\r\n    formatPeakData(data) {\r\n        var arr = data.split(',');\r\n        arr[0] = ' ' + arr[0] + ' dBc';\r\n        arr[1] = arr[1] + ' dBm';\r\n        arr.reverse();\r\n        var final = arr.join();\r\n        return final;\r\n    }\r\n\r\n    formatDate() {\r\n        var dt = new Date();\r\n        return (`${dt.getHours().toString().padStart(2, '0')}:${dt.getMinutes().toString().padStart(2, '0')}:${dt.getSeconds().toString().padStart(2, '0')}`);\r\n    }\r\n\r\n    savePower(evt) {\r\n        if(evt) {\r\n            if(evt.target.value < 20) evt.target.value = 20;\r\n            if(evt.target.value > 46) evt.target.value = 46;\r\n            localStorage.setItem('power', evt.target.value);\r\n        } else {\r\n            var power = 43;\r\n            try {\r\n                var local = JSON.parse(localStorage.getItem('power'));\r\n                if(local) power = local;\r\n            } catch (e) {\r\n                console.log(e);\r\n            } finally {\r\n                document.getElementById('outputPowerLevel').value = power;\r\n                localStorage.setItem('power', power);\r\n            }\r\n        }\r\n    }\r\n\r\n    saveDuration(evt) {\r\n        if(evt) {\r\n            if(evt.target.value < 1) evt.target.value = 1;\r\n            if(evt.target.value > 600) evt.target.value = 600;\r\n            localStorage.setItem('duration', evt.target.value);\r\n        } else {\r\n            var duration = 30;\r\n            try {\r\n                var local = JSON.parse(localStorage.getItem('duration'));\r\n                if(local) duration = local;\r\n            } catch (e) {\r\n                console.log(e);\r\n            } finally {\r\n                document.getElementById('testDuration').value = duration;\r\n                localStorage.setItem('duration', duration);\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        // TODO: try to use these methods from PIM class file\r\n        this.savePower();\r\n        this.saveDuration();\r\n    }\r\n\r\n}\r\n\r\nexport default Autotest;\r\n"]},"metadata":{},"sourceType":"module"}