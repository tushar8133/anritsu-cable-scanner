{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\amnaonoip\\\\Desktop\\\\anritsu-cable-scanner\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import XLSX from'xlsx';var AutotestTable=/*#__PURE__*/function(_React$Component){_inherits(AutotestTable,_React$Component);function AutotestTable(props){var _this;_classCallCheck(this,AutotestTable);_this=_possibleConstructorReturn(this,_getPrototypeOf(AutotestTable).call(this,props));_this.state={tableData:[{\"qrcode\":\"a\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:29\"},{\"qrcode\":\"b\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:31\"},{\"qrcode\":\"c\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:33\"},{\"qrcode\":\"d\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:34\"},{\"qrcode\":\"e\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:36\"},{\"qrcode\":\"f\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:37\"},{\"qrcode\":\"g\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:39\"},{\"qrcode\":\"h\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:44\"},{\"qrcode\":\"i\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:46\"},{\"qrcode\":\"j\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:48\"},{\"qrcode\":\"k\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:51\"},{\"qrcode\":\"l\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:52\"},{\"qrcode\":\"m\",\"power\":\"41\",\"duration\":\"33\",\"dBm\":\"u\",\"dBc\":\"n\",\"timestamp\":\"13:02:54\"}]};return _this;}_createClass(AutotestTable,[{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(props){var finalData=this.checkDuplicate(this.state.tableData,props.addon);this.setState({tableData:finalData});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){var scrollDiv=document.querySelector('#autotesttable > div');scrollDiv.scrollTop=scrollDiv.scrollHeight;}},{key:\"render\",value:function render(){var _this2=this;return React.createElement(\"main\",{id:\"autotesttable\",align:\"center\"},React.createElement(\"div\",null,React.createElement(\"table\",{id:\"data-table\",border:\"1\"},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"#\"),React.createElement(\"th\",null,\"Serial No.\"),React.createElement(\"th\",null,\"Power\"),React.createElement(\"th\",null,\"Duration\"),React.createElement(\"th\",null,\"dBm\"),React.createElement(\"th\",null,\"dBc\"),React.createElement(\"th\",null,\"Timestamp\"),React.createElement(\"th\",null,\"Delete\"))),React.createElement(\"tbody\",null,this.state.tableData.map(function(row,index){return React.createElement(\"tr\",{key:row.qrcode},React.createElement(\"td\",null,index+1),React.createElement(\"td\",null,row.qrcode),React.createElement(\"td\",null,row.power),React.createElement(\"td\",null,row.duration),React.createElement(\"td\",null,row.dBm),React.createElement(\"td\",null,row.dBc),React.createElement(\"td\",null,row.timestamp),React.createElement(\"td\",null,React.createElement(\"button\",{onClick:function onClick(_){return _this2.deleteRow(index);}},\"\\u2715\")));})))),React.createElement(\"button\",{onClick:function onClick(_){return _this2.exportData();}},\"Save Excel\"));}},{key:\"deleteRow\",value:function deleteRow(index){console.log(index);var duplicateState=_toConsumableArray(this.state.tableData);duplicateState.splice(index,1);this.setState({tableData:duplicateState});}},{key:\"checkDuplicate\",value:function checkDuplicate(oldData,newData){var unique=oldData.filter(function(val,index){return val.qrcode!==newData.qrcode;});unique.push(newData);return unique;}},{key:\"formatDate\",value:function formatDate(type){var dt=new Date();if(type==='print')return\"\".concat(dt.getFullYear().toString().padStart(4,'0'),\"-\").concat((dt.getMonth()+1).toString().padStart(2,'0'),\"-\").concat(dt.getDate().toString().padStart(2,'0'),\" \").concat(dt.getHours().toString().padStart(2,'0'),\":\").concat(dt.getMinutes().toString().padStart(2,'0'),\":\").concat(dt.getSeconds().toString().padStart(2,'0'));if(type==='save')return\"\".concat(dt.getFullYear().toString().padStart(4,'0'),\"-\").concat((dt.getMonth()+1).toString().padStart(2,'0'),\"-\").concat(dt.getDate().toString().padStart(2,'0'),\"  (\").concat(dt.getHours().toString().padStart(2,'0')).concat(dt.getMinutes().toString().padStart(2,'0'),\")\");}},{key:\"exportData\",value:function exportData(){var person=prompt('Please enter OPERATOR NAME');if(!person){alert('OPERATOR NAME is required!');return false;}console.table(this.state.tableData);var data=_toConsumableArray(this.state.tableData);var newData=data.map(function(obj,index){return Object.assign({index:String(index+1)},obj);});// console.table(newData);\nthis.xlsxModule(person,newData);}},{key:\"xlsxModule\",value:function xlsxModule(person,data){var ws=XLSX.utils.json_to_sheet([{A:'Operator Name',B:person},{A:'Date',B:this.formatDate('print')}],{header:['A','B'],skipHeader:true});XLSX.utils.sheet_add_json(ws,data,{skipHeader:false,origin:'A4'});var wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws);XLSX.writeFile(wb,\"Anritsu Test -- \".concat(this.formatDate('save'),\".xlsx\"));}}]);return AutotestTable;}(React.Component);export default AutotestTable;","map":{"version":3,"sources":["C:/Users/amnaonoip/Desktop/anritsu-cable-scanner/src/components/AutotestTable.js"],"names":["React","XLSX","AutotestTable","props","state","tableData","finalData","checkDuplicate","addon","setState","scrollDiv","document","querySelector","scrollTop","scrollHeight","map","row","index","qrcode","power","duration","dBm","dBc","timestamp","_","deleteRow","exportData","console","log","duplicateState","splice","oldData","newData","unique","filter","val","push","type","dt","Date","getFullYear","toString","padStart","getMonth","getDate","getHours","getMinutes","getSeconds","person","prompt","alert","table","data","obj","Object","assign","String","xlsxModule","ws","utils","json_to_sheet","A","B","formatDate","header","skipHeader","sheet_add_json","origin","wb","book_new","book_append_sheet","writeFile","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport XLSX from 'xlsx';\r\n\r\nclass AutotestTable extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            tableData: [{ \"qrcode\": \"a\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:29\" }, { \"qrcode\": \"b\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:31\" }, { \"qrcode\": \"c\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:33\" }, { \"qrcode\": \"d\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:34\" }, { \"qrcode\": \"e\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:36\" }, { \"qrcode\": \"f\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:37\" }, { \"qrcode\": \"g\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:39\" }, { \"qrcode\": \"h\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:44\" }, { \"qrcode\": \"i\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:46\" }, { \"qrcode\": \"j\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:48\" }, { \"qrcode\": \"k\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:51\" }, { \"qrcode\": \"l\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:52\" }, { \"qrcode\": \"m\", \"power\": \"41\", \"duration\": \"33\", \"dBm\": \"u\", \"dBc\": \"n\", \"timestamp\": \"13:02:54\" }]\r\n        };\r\n    }\r\n\r\n    componentWillReceiveProps(props) {\r\n        var finalData = this.checkDuplicate(this.state.tableData, props.addon);\r\n        this.setState({ tableData: finalData });\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        var scrollDiv = document.querySelector('#autotesttable > div');\r\n        scrollDiv.scrollTop = scrollDiv.scrollHeight;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <main id=\"autotesttable\" align=\"center\">\r\n                <div>\r\n                    <table id=\"data-table\" border=\"1\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>#</th>\r\n                                <th>Serial No.</th>\r\n                                <th>Power</th>\r\n                                <th>Duration</th>\r\n                                <th>dBm</th>\r\n                                <th>dBc</th>\r\n                                <th>Timestamp</th>\r\n                                <th>Delete</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {this.state.tableData.map((row, index) => <tr key={row.qrcode}><td>{index + 1}</td><td>{row.qrcode}</td><td>{row.power}</td><td>{row.duration}</td><td>{row.dBm}</td><td>{row.dBc}</td><td>{row.timestamp}</td><td><button onClick={_ => this.deleteRow(index)}>&#10005;</button></td></tr>)}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n                <button onClick={_ => this.exportData()}>Save Excel</button>\r\n            </main>);\r\n    }\r\n\r\n    deleteRow(index) {\r\n        console.log(index);\r\n        var duplicateState = [...this.state.tableData];\r\n        duplicateState.splice(index, 1);\r\n        this.setState({\r\n            tableData: duplicateState\r\n        })\r\n    }\r\n\r\n    checkDuplicate(oldData, newData) {\r\n        var unique = oldData.filter((val, index) => {\r\n            return (val.qrcode !== newData.qrcode);\r\n        });\r\n        unique.push(newData)\r\n        return unique;\r\n    }\r\n\r\n    formatDate(type) {\r\n        var dt = new Date();\r\n        if(type === 'print') return (`${dt.getFullYear().toString().padStart(4, '0')}-${(dt.getMonth() + 1).toString().padStart(2, '0')}-${dt.getDate().toString().padStart(2, '0')} ${dt.getHours().toString().padStart(2, '0')}:${dt.getMinutes().toString().padStart(2, '0')}:${dt.getSeconds().toString().padStart(2, '0')}`);\r\n        if(type === 'save') return (`${dt.getFullYear().toString().padStart(4, '0')}-${(dt.getMonth() + 1).toString().padStart(2, '0')}-${dt.getDate().toString().padStart(2, '0')}  (${dt.getHours().toString().padStart(2, '0')}${dt.getMinutes().toString().padStart(2, '0')})`);\r\n    }\r\n\r\n    exportData() {\r\n        var person = prompt('Please enter OPERATOR NAME');\r\n        if (!person) {\r\n            alert('OPERATOR NAME is required!');\r\n            return false;\r\n        }\r\n        console.table(this.state.tableData)\r\n        var data = [...this.state.tableData];\r\n        var newData = data.map((obj, index) => {\r\n            return Object.assign({ index: String(index + 1) }, obj)\r\n        })\r\n        // console.table(newData);\r\n        this.xlsxModule(person, newData);\r\n    }\r\n\r\n    xlsxModule(person, data) {\r\n        var ws = XLSX.utils.json_to_sheet([{ A: 'Operator Name', B: person }, { A: 'Date', B: this.formatDate('print') }], { header: ['A', 'B'], skipHeader: true });\r\n        XLSX.utils.sheet_add_json(ws, data, { skipHeader: false, origin: 'A4' });\r\n        const wb = XLSX.utils.book_new();\r\n        XLSX.utils.book_append_sheet(wb, ws);\r\n        XLSX.writeFile(wb, `Anritsu Test -- ${this.formatDate('save')}.xlsx`);\r\n    }\r\n}\r\n\r\nexport default AutotestTable;\r\n"]},"metadata":{},"sourceType":"module"}